"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6534],{65310:function(t,e,n){n.d(e,{Dp:function(){return o},G:function(){return i},Z$:function(){return s},kJ:function(){return c},s7:function(){return r}});let s=t=>t[t.length-1],r=(t,e)=>{for(let n=0;n<e.length;n++)t.push(e[n])},o=Array.from,i=(t,e)=>{for(let n=0;n<t.length;n++)if(e(t[n],n,t))return!0;return!1},c=Array.isArray},10731:function(t,e,n){n.d(e,{$2:function(){return h},CY:function(){return o},Ko:function(){return i},Qn:function(){return r},RP:function(){return f},Tg:function(){return p},Vw:function(){return s},cq:function(){return c},jS:function(){return d},kr:function(){return l},rc:function(){return u},x1:function(){return a}});let s=1,r=2,o=4,i=8,c=32,u=64,a=128,l=31,h=63,d=127,f=2147483647,p=4294967295},98243:function(t,e,n){n.d(e,{Gh:function(){return l},eh:function(){return u},f9:function(){return h},s3:function(){return a}});var s=n(7003),r=n(72934),o=n(52383).Buffer;let i=t=>new Uint8Array(t),c=(t,e,n)=>new Uint8Array(t,e,n),u=t=>new Uint8Array(t),a=r.jU?t=>{let e="";for(let n=0;n<t.byteLength;n++)e+=s.IK(t[n]);return btoa(e)}:t=>o.from(t.buffer,t.byteOffset,t.byteLength).toString("base64"),l=r.jU?t=>{let e=atob(t),n=i(e.length);for(let t=0;t<e.length;t++)n[t]=e.charCodeAt(t);return n}:t=>{let e=o.from(t,"base64");return c(e.buffer,e.byteOffset,e.byteLength)},h=t=>{let e=i(t.byteLength);return e.set(t),e}},9685:function(t,e,n){n.d(e,{HN:function(){return p},UF:function(){return x},XW:function(){return E},dD:function(){return S},kf:function(){return _},kj:function(){return g},l1:function(){return h},sO:function(){return U},v_:function(){return v},yg:function(){return m}});var s=n(10731),r=n(34850),o=n(5613),i=n(7003),c=n(82439);let u=c.Ue("Unexpected end of array"),a=c.Ue("Integer out of Range");class l{constructor(t){this.arr=t,this.pos=0}}let h=t=>new l(t),d=t=>t.pos!==t.arr.length,f=(t,e)=>{let n=new Uint8Array(t.arr.buffer,t.pos+t.arr.byteOffset,e);return t.pos+=e,n},p=t=>f(t,m(t)),g=t=>t.arr[t.pos++],m=t=>{let e=0,n=1,r=t.arr.length;for(;t.pos<r;){let r=t.arr[t.pos++];if(e+=(r&s.jS)*n,n*=128,r<s.x1)return e;if(e>o.YM)throw a}throw u},y=t=>{let e=t.arr[t.pos++],n=e&s.$2,r=64,i=(e&s.rc)>0?-1:1;if((e&s.x1)==0)return i*n;let c=t.arr.length;for(;t.pos<c;){if(n+=((e=t.arr[t.pos++])&s.jS)*r,r*=128,e<s.x1)return i*n;if(n>o.YM)throw a}throw u},_=i.CO?t=>i.CO.decode(p(t)):t=>{let e=m(t);if(0===e)return"";{let n=String.fromCodePoint(g(t));if(--e<100)for(;e--;)n+=String.fromCodePoint(g(t));else for(;e>0;){let s=e<1e4?e:1e4,r=t.arr.subarray(t.pos,t.pos+s);t.pos+=s,n+=String.fromCodePoint.apply(null,r),e-=s}return decodeURIComponent(escape(n))}},w=(t,e)=>{let n=new DataView(t.arr.buffer,t.arr.byteOffset+t.pos,e);return t.pos+=e,n},b=[t=>void 0,t=>null,y,t=>w(t,4).getFloat32(0,!1),t=>w(t,8).getFloat64(0,!1),t=>w(t,8).getBigInt64(0,!1),t=>!1,t=>!0,_,t=>{let e=m(t),n={};for(let s=0;s<e;s++)n[_(t)]=v(t);return n},t=>{let e=m(t),n=[];for(let s=0;s<e;s++)n.push(v(t));return n},p],v=t=>b[127-g(t)](t);class E extends l{constructor(t,e){super(t),this.reader=e,this.s=null,this.count=0}read(){return 0===this.count&&(this.s=this.reader(this),d(this)?this.count=m(this)+1:this.count=-1),this.count--,this.s}}class x extends l{constructor(t){super(t),this.s=0,this.count=0}read(){if(0===this.count){this.s=y(this);let t=r.GR(this.s);this.count=1,t&&(this.s=-this.s,this.count=m(this)+2)}return this.count--,this.s}}class S extends l{constructor(t){super(t),this.s=0,this.count=0,this.diff=0}read(){if(0===this.count){let t=y(this);this.diff=r.GW(t/2),this.count=1,1&t&&(this.count=m(this)+2)}return this.s+=this.diff,this.count--,this.s}}class U{constructor(t){this.decoder=new x(t),this.str=_(this.decoder),this.spos=0}read(){let t=this.spos+this.decoder.read(),e=this.str.slice(this.spos,t);return this.spos=t,e}}},63297:function(t,e,n){n.d(e,{JU:function(){return r},x0:function(){return o}});var s=n(89838);let r="undefined"!=typeof document?document:{};"undefined"!=typeof DOMParser&&new DOMParser;let o=t=>s.UI(t,(t,e)=>`${e}:${t};`).join("");r.ELEMENT_NODE,r.TEXT_NODE,r.CDATA_SECTION_NODE,r.COMMENT_NODE,r.DOCUMENT_NODE,r.DOCUMENT_TYPE_NODE,r.DOCUMENT_FRAGMENT_NODE},55999:function(t,e,n){n.d(e,{$F:function(){return p},EM:function(){return L},GF:function(){return T},HE:function(){return O},HK:function(){return b},Mf:function(){return a},TS:function(){return N},_f:function(){return h},kE:function(){return l},mP:function(){return v},sX:function(){return I},uE:function(){return g},uw:function(){return w}});var s=n(34850),r=n(5613),o=n(10731),i=n(7003),c=n(65310);class u{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}let a=()=>new u,l=t=>{let e=t.cpos;for(let n=0;n<t.bufs.length;n++)e+=t.bufs[n].length;return e},h=t=>{let e=new Uint8Array(l(t)),n=0;for(let s=0;s<t.bufs.length;s++){let r=t.bufs[s];e.set(r,n),n+=r.length}return e.set(new Uint8Array(t.cbuf.buffer,0,t.cpos),n),e},d=(t,e)=>{let n=t.cbuf.length;n-t.cpos<e&&(t.bufs.push(new Uint8Array(t.cbuf.buffer,0,t.cpos)),t.cbuf=new Uint8Array(2*s.Fp(n,e)),t.cpos=0)},f=(t,e)=>{let n=t.cbuf.length;t.cpos===n&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(2*n),t.cpos=0),t.cbuf[t.cpos++]=e},p=f,g=(t,e)=>{for(;e>o.jS;)f(t,o.x1|o.jS&e),e=s.GW(e/128);f(t,o.jS&e)},m=(t,e)=>{let n=s.GR(e);for(n&&(e=-e),f(t,(e>o.$2?o.x1:0)|(n?o.rc:0)|o.$2&e),e=s.GW(e/64);e>0;)f(t,(e>o.jS?o.x1:0)|o.jS&e),e=s.GW(e/128)},y=new Uint8Array(3e4),_=y.length/3,w=i.YZ&&i.YZ.encodeInto?(t,e)=>{if(e.length<_){let n=i.YZ.encodeInto(e,y).written||0;g(t,n);for(let e=0;e<n;e++)f(t,y[e])}else v(t,i.lz(e))}:(t,e)=>{let n=unescape(encodeURIComponent(e)),s=n.length;g(t,s);for(let e=0;e<s;e++)f(t,n.codePointAt(e))},b=(t,e)=>{let n=t.cbuf.length,r=t.cpos,o=s.VV(n-r,e.length),i=e.length-o;t.cbuf.set(e.subarray(0,o),r),t.cpos+=o,i>0&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(s.Fp(2*n,i)),t.cbuf.set(e.subarray(o)),t.cpos=i)},v=(t,e)=>{g(t,e.byteLength),b(t,e)},E=(t,e)=>{d(t,e);let n=new DataView(t.cbuf.buffer,t.cpos,e);return t.cpos+=e,n},x=(t,e)=>E(t,4).setFloat32(0,e,!1),S=(t,e)=>E(t,8).setFloat64(0,e,!1),U=(t,e)=>E(t,8).setBigInt64(0,e,!1),k=new DataView(new ArrayBuffer(4)),C=t=>(k.setFloat32(0,t),k.getFloat32(0)===t),L=(t,e)=>{switch(typeof e){case"string":f(t,119),w(t,e);break;case"number":r.U(e)&&s.Wn(e)<=o.RP?(f(t,125),m(t,e)):C(e)?(f(t,124),x(t,e)):(f(t,123),S(t,e));break;case"bigint":f(t,122),U(t,e);break;case"object":if(null===e)f(t,126);else if(c.kJ(e)){f(t,117),g(t,e.length);for(let n=0;n<e.length;n++)L(t,e[n])}else if(e instanceof Uint8Array)f(t,116),v(t,e);else{f(t,118);let n=Object.keys(e);g(t,n.length);for(let s=0;s<n.length;s++){let r=n[s];w(t,r),L(t,e[r])}}break;case"boolean":f(t,e?120:121);break;default:f(t,127)}};class T extends u{constructor(t){super(),this.w=t,this.s=null,this.count=0}write(t){this.s===t?this.count++:(this.count>0&&g(this,this.count-1),this.count=1,this.w(this,t),this.s=t)}}let M=t=>{t.count>0&&(m(t.encoder,1===t.count?t.s:-t.s),t.count>1&&g(t.encoder,t.count-2))};class O{constructor(){this.encoder=new u,this.s=0,this.count=0}write(t){this.s===t?this.count++:(M(this),this.count=1,this.s=t)}toUint8Array(){return M(this),h(this.encoder)}}let P=t=>{if(t.count>0){let e=2*t.diff+(1===t.count?0:1);m(t.encoder,e),t.count>1&&g(t.encoder,t.count-2)}};class I{constructor(){this.encoder=new u,this.s=0,this.count=0,this.diff=0}write(t){this.diff===t-this.s?(this.s=t,this.count++):(P(this),this.count=1,this.diff=t-this.s,this.s=t)}toUint8Array(){return P(this),h(this.encoder)}}class N{constructor(){this.sarr=[],this.s="",this.lensE=new O}write(t){this.s+=t,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(t.length)}toUint8Array(){let t=new u;return this.sarr.push(this.s),this.s="",w(t,this.sarr.join("")),b(t,this.lensE.toUint8Array()),h(t)}}},72934:function(t,e,n){let s,r;n.d(e,{jU:function(){return d},hH:function(){return _}});var o=n(89838),i=n(7003);let c=t=>void 0===t?null:t;var u=n(46038),a=n(56503),l=n(32608);let h=void 0!==l&&l.release&&/node|io\.js/.test(l.release.name)&&"[object process]"===Object.prototype.toString.call(void 0!==l?l:0),d="undefined"!=typeof window&&"undefined"!=typeof document&&!h;"undefined"!=typeof navigator&&/Mac/.test(navigator.platform);let f=[],p=()=>{if(void 0===s){if(h){s=o.Ue();let t=l.argv,e=null;for(let n=0;n<t.length;n++){let r=t[n];"-"===r[0]?(null!==e&&s.set(e,""),e=r):null!==e?(s.set(e,r),e=null):f.push(r)}null!==e&&s.set(e,"")}else"object"==typeof location?(s=o.Ue(),(location.search||"?").slice(1).split("&").forEach(t=>{if(0!==t.length){let[e,n]=t.split("=");s.set(`--${i.NF(e,"-")}`,n),s.set(`-${i.NF(e,"-")}`,n)}})):s=o.Ue()}return s},g=t=>p().has(t),m=t=>h?c(l.env[t.toUpperCase().replaceAll("-","_")]):c(u.XN.getItem(t));g("--"+(r="production"))||m(r);let y=h&&a.gB(l.env.FORCE_COLOR,["true","1","2"]),_=!g("--no-colors")&&(!h||l.stdout.isTTY||y)&&(!h||g("--color")||y||null!==m("COLORTERM")||(m("TERM")||"").includes("color"))},82439:function(t,e,n){n.d(e,{Nw:function(){return r},Ue:function(){return s},zR:function(){return o}});let s=t=>Error(t),r=()=>{throw s("Method unimplemented")},o=()=>{throw s("Unexpected case")}},56503:function(t,e,n){n.d(e,{Hi:function(){return u},PP:function(){return o},gB:function(){return a},id:function(){return i}});var s=n(65310),r=n(31399);let o=(t,e,n=0)=>{try{for(;n<t.length;n++)t[n](...e)}finally{n<t.length&&o(t,e,n+1)}},i=t=>t,c=(t,e)=>t===e,u=(t,e)=>{if(null==t||null==e)return c(t,e);if(t.constructor!==e.constructor)return!1;if(t===e)return!0;switch(t.constructor){case ArrayBuffer:t=new Uint8Array(t),e=new Uint8Array(e);case Uint8Array:if(t.byteLength!==e.byteLength)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;break;case Set:if(t.size!==e.size)return!1;for(let n of t)if(!e.has(n))return!1;break;case Map:if(t.size!==e.size)return!1;for(let n of t.keys())if(!e.has(n)||!u(t.get(n),e.get(n)))return!1;break;case Object:if(r.kE(t)!==r.kE(e))return!1;for(let n in t)if(!r.l$(t,n)||!u(t[n],e[n]))return!1;break;case Array:if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!u(t[n],e[n]))return!1;break;default:return!1}return!0},a=(t,e)=>e.includes(t);s.kJ},12161:function(t,e,n){n.d(e,{BG:function(){return r},CA:function(){return o}});let s=t=>({[Symbol.iterator](){return this},next:t}),r=(t,e)=>s(()=>{let n;do n=t.next();while(!n.done&&!e(n.value));return n}),o=(t,e)=>s(()=>{let{done:n,value:s}=t.next();return{done:n,value:n?void 0:e(s)}})},54238:function(t,e,n){n.d(e,{Ej:function(){return c},Pl:function(){return o},ZA:function(){return a},s7:function(){return u},ud:function(){return d},Wd:function(){return h},hM:function(){return l},YW:function(){return i},WO:function(){return f},_X:function(){return p}});let s=Symbol;var r=n(34002);let o=s(),i=s(),c=s(),u=s(),a=s(),l=s(),h=s(),d=s(),f=s(),p=t=>{1===t.length&&t[0]?.constructor===Function&&(t=t[0]());let e=[],n=[],s=0;for(;s<t.length;s++){let r=t[s];void 0===r?e.push("undefined"):r.constructor===String||r.constructor===Number?e.push(r):r.constructor===Object&&n.push(JSON.stringify(r))}return n};r.ZG()},35607:function(t,e,n){n.d(e,{S0:function(){return d},ZK:function(){return f}});var s=n(72934),r=n(83896);class o{constructor(t,e){this.left=t,this.right=e}}let i=(t,e)=>new o(t,e);var c=n(63297),u=n(89838),a=n(54238);let l={[a.Pl]:i("font-weight","bold"),[a.YW]:i("font-weight","normal"),[a.Ej]:i("color","blue"),[a.ZA]:i("color","green"),[a.s7]:i("color","grey"),[a.hM]:i("color","red"),[a.Wd]:i("color","purple"),[a.ud]:i("color","orange"),[a.WO]:i("color","black")},h=s.hH?t=>{1===t.length&&t[0]?.constructor===Function&&(t=t[0]());let e=[],n=[],s=u.Ue(),r=[],o=0;for(;o<t.length;o++){let r=t[o],i=l[r];if(void 0!==i)s.set(i.left,i.right);else{if(void 0===r)break;if(r.constructor===String||r.constructor===Number){let t=c.x0(s);o>0||t.length>0?(e.push("%c"+r),n.push(t)):e.push(r)}else break}}for(o>0&&(r=n).unshift(e.join(""));o<t.length;o++){let e=t[o];e instanceof Symbol||r.push(e)}return r}:a._X,d=(...t)=>{console.log(...h(t)),p.forEach(e=>e.print(t))},f=(...t)=>{console.warn(...h(t)),t.unshift(a.ud),p.forEach(e=>e.print(t))},p=r.Ue()},89838:function(t,e,n){n.d(e,{JG:function(){return r},UI:function(){return i},Ue:function(){return s},Yj:function(){return c},Yu:function(){return o}});let s=()=>new Map,r=t=>{let e=s();return t.forEach((t,n)=>{e.set(n,t)}),e},o=(t,e,n)=>{let s=t.get(e);return void 0===s&&t.set(e,s=n()),s},i=(t,e)=>{let n=[];for(let[s,r]of t)n.push(e(r,s));return n},c=(t,e)=>{for(let[n,s]of t)if(e(s,n))return!0;return!1}},34850:function(t,e,n){n.d(e,{Fp:function(){return i},GR:function(){return u},GW:function(){return s},VV:function(){return o},Wn:function(){return r},sQ:function(){return c}});let s=Math.floor,r=Math.abs,o=(t,e)=>t<e?t:e,i=(t,e)=>t>e?t:e,c=Math.pow,u=t=>0!==t?t<0:1/t<0},5613:function(t,e,n){n.d(e,{U:function(){return i},YM:function(){return o}});var s=n(34850),r=n(10731);let o=Number.MAX_SAFE_INTEGER;r.RP,r.Tg;let i=Number.isInteger||(t=>"number"==typeof t&&isFinite(t)&&s.GW(t)===t)},31399:function(t,e,n){n.d(e,{$m:function(){return d},Ed:function(){return o},UI:function(){return i},XP:function(){return r},f0:function(){return s},kE:function(){return c},l$:function(){return h},xb:function(){return a}});let s=Object.assign,r=Object.keys,o=(t,e)=>{for(let n in t)e(t[n],n)},i=(t,e)=>{let n=[];for(let s in t)n.push(e(t[s],s));return n},c=t=>r(t).length,u=t=>r(t).length,a=t=>{for(let e in t)return!1;return!0},l=(t,e)=>{for(let n in t)if(!e(t[n],n))return!1;return!0},h=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),d=(t,e)=>t===e||u(t)===u(e)&&l(t,(t,n)=>(void 0!==t||h(e,n))&&e[n]===t)},3822:function(t,e,n){n.d(e,{g:function(){return i},y:function(){return c}});var s=n(89838),r=n(83896),o=n(65310);class i{constructor(){this._observers=s.Ue()}on(t,e){return s.Yu(this._observers,t,r.Ue).add(e),e}once(t,e){let n=(...s)=>{this.off(t,n),e(...s)};this.on(t,n)}off(t,e){let n=this._observers.get(t);void 0!==n&&(n.delete(e),0===n.size&&this._observers.delete(t))}emit(t,e){return o.Dp((this._observers.get(t)||s.Ue()).values()).forEach(t=>t(...e))}destroy(){this._observers=s.Ue()}}class c{constructor(){this._observers=s.Ue()}on(t,e){s.Yu(this._observers,t,r.Ue).add(e)}once(t,e){let n=(...s)=>{this.off(t,n),e(...s)};this.on(t,n)}off(t,e){let n=this._observers.get(t);void 0!==n&&(n.delete(e),0===n.size&&this._observers.delete(t))}emit(t,e){return o.Dp((this._observers.get(t)||s.Ue()).values()).forEach(t=>t(...e))}destroy(){this._observers=s.Ue()}}},31175:function(t,e,n){n.d(e,{Ue:function(){return s}});let s=t=>new Promise(t);Promise.all.bind(Promise)},97737:function(t,e,n){n.d(e,{kw:function(){return c},U7:function(){return i},k$:function(){return u}});var s=n(34850);crypto.subtle;let r=crypto.getRandomValues.bind(crypto),o=Math.random,i=()=>r(new Uint32Array(1))[0],c=t=>t[s.GW(o()*t.length)],u=()=>"10000000-1000-4000-8000-100000000000".replace(/[018]/g,t=>(t^i()&15>>t/4).toString(16))},83896:function(t,e,n){n.d(e,{Ue:function(){return s}});let s=()=>new Set},46038:function(t,e,n){n.d(e,{F:function(){return u},XN:function(){return i},z2:function(){return c}});class s{constructor(){this.map=new Map}setItem(t,e){this.map.set(t,e)}getItem(t){return this.map.get(t)}}let r=new s,o=!0;try{"undefined"!=typeof localStorage&&localStorage&&(r=localStorage,o=!1)}catch(t){}let i=r,c=t=>o||addEventListener("storage",t),u=t=>o||removeEventListener("storage",t)},7003:function(t,e,n){n.d(e,{CO:function(){return h},IK:function(){return s},NF:function(){return u},YZ:function(){return a},lz:function(){return l}});let s=String.fromCharCode;s(65535);let r=t=>t.toLowerCase(),o=/^\s*/g,i=t=>t.replace(o,""),c=/([A-Z])/g,u=(t,e)=>i(t.replace(c,t=>`${e}${r(t)}`)),a="undefined"!=typeof TextEncoder?new TextEncoder:null,l=a?t=>a.encode(t):t=>{let e=unescape(encodeURIComponent(t)),n=e.length,s=new Uint8Array(n);for(let t=0;t<n;t++)s[t]=e.codePointAt(t);return s},h="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});h&&1===h.decode(new Uint8Array).length&&(h=null)},34002:function(t,e,n){n.d(e,{ZG:function(){return s}});let s=Date.now},60570:function(t,e,n){n.d(e,{ZP:function(){return _}});var s=n(32608);globalThis.EventTarget&&globalThis.Event||console.error(`
  PartySocket requires a global 'EventTarget' class to be available!
  You can polyfill this global by adding this to your code before any partysocket imports: 
  
  \`\`\`
  import 'partysocket/event-target-polyfill';
  \`\`\`
  Please file an issue at https://github.com/partykit/partykit if you're still having trouble.
`);var r=class extends Event{message;error;constructor(t,e){super("error",e),this.message=t.message,this.error=t}},o=class extends Event{code;reason;wasClean=!0;constructor(t=1e3,e="",n){super("close",n),this.code=t,this.reason=e}},i={ErrorEvent:r,CloseEvent:o},c=void 0!==s&&void 0!==s.versions?.node&&"undefined"==typeof document?function(t){return"data"in t?new MessageEvent(t.type,t):"code"in t||"reason"in t?new o(t.code||1999,t.reason||"unknown reason",t):"error"in t?new r(t.error,t):new Event(t.type,t)}:function(t){return new t.constructor(t.type,t)},u={maxReconnectionDelay:1e4,minReconnectionDelay:1e3+4e3*Math.random(),minUptime:5e3,reconnectionDelayGrowFactor:1.3,connectionTimeout:4e3,maxRetries:1/0,maxEnqueuedMessages:1/0},a=!1,l=class t extends EventTarget{_ws;_retryCount=-1;_uptimeTimeout;_connectTimeout;_shouldReconnect=!0;_connectLock=!1;_binaryType="blob";_closeCalled=!1;_messageQueue=[];_debugLogger=console.log.bind(console);_url;_protocols;_options;constructor(t,e,n={}){super(),this._url=t,this._protocols=e,this._options=n,this._options.startClosed&&(this._shouldReconnect=!1),this._options.debugLogger&&(this._debugLogger=this._options.debugLogger),this._connect()}static get CONNECTING(){return 0}static get OPEN(){return 1}static get CLOSING(){return 2}static get CLOSED(){return 3}get CONNECTING(){return t.CONNECTING}get OPEN(){return t.OPEN}get CLOSING(){return t.CLOSING}get CLOSED(){return t.CLOSED}get binaryType(){return this._ws?this._ws.binaryType:this._binaryType}set binaryType(t){this._binaryType=t,this._ws&&(this._ws.binaryType=t)}get retryCount(){return Math.max(this._retryCount,0)}get bufferedAmount(){return this._messageQueue.reduce((t,e)=>("string"==typeof e?t+=e.length:e instanceof Blob?t+=e.size:t+=e.byteLength,t),0)+(this._ws?this._ws.bufferedAmount:0)}get extensions(){return this._ws?this._ws.extensions:""}get protocol(){return this._ws?this._ws.protocol:""}get readyState(){return this._ws?this._ws.readyState:this._options.startClosed?t.CLOSED:t.CONNECTING}get url(){return this._ws?this._ws.url:""}get shouldReconnect(){return this._shouldReconnect}onclose=null;onerror=null;onmessage=null;onopen=null;close(t=1e3,e){if(this._closeCalled=!0,this._shouldReconnect=!1,this._clearTimeouts(),!this._ws){this._debug("close enqueued: no ws instance");return}if(this._ws.readyState===this.CLOSED){this._debug("close: already closed");return}this._ws.close(t,e)}reconnect(t,e){this._shouldReconnect=!0,this._closeCalled=!1,this._retryCount=-1,this._ws&&this._ws.readyState!==this.CLOSED&&this._disconnect(t,e),this._connect()}send(t){if(this._ws&&this._ws.readyState===this.OPEN)this._debug("send",t),this._ws.send(t);else{let{maxEnqueuedMessages:e=u.maxEnqueuedMessages}=this._options;this._messageQueue.length<e&&(this._debug("enqueue",t),this._messageQueue.push(t))}}_debug(...t){this._options.debug&&this._debugLogger("RWS>",...t)}_getNextDelay(){let{reconnectionDelayGrowFactor:t=u.reconnectionDelayGrowFactor,minReconnectionDelay:e=u.minReconnectionDelay,maxReconnectionDelay:n=u.maxReconnectionDelay}=this._options,s=0;return this._retryCount>0&&(s=e*Math.pow(t,this._retryCount-1))>n&&(s=n),this._debug("next delay",s),s}_wait(){return new Promise(t=>{setTimeout(t,this._getNextDelay())})}_getNextProtocols(t){if(!t)return Promise.resolve(null);if("string"==typeof t||Array.isArray(t))return Promise.resolve(t);if("function"==typeof t){let e=t();if(!e)return Promise.resolve(null);if("string"==typeof e||Array.isArray(e))return Promise.resolve(e);if(e.then)return e}throw Error("Invalid protocols")}_getNextUrl(t){if("string"==typeof t)return Promise.resolve(t);if("function"==typeof t){let e=t();if("string"==typeof e)return Promise.resolve(e);if(e.then)return e}throw Error("Invalid URL")}_connect(){if(this._connectLock||!this._shouldReconnect)return;this._connectLock=!0;let{maxRetries:t=u.maxRetries,connectionTimeout:e=u.connectionTimeout}=this._options;if(this._retryCount>=t){this._debug("max retries reached",this._retryCount,">=",t);return}this._retryCount++,this._debug("connect",this._retryCount),this._removeListeners(),this._wait().then(()=>Promise.all([this._getNextUrl(this._url),this._getNextProtocols(this._protocols||null)])).then(([t,n])=>{if(this._closeCalled){this._connectLock=!1;return}this._options.WebSocket||"undefined"!=typeof WebSocket||a||(console.error(`\u203C\uFE0F No WebSocket implementation available. You should define options.WebSocket. 

For example, if you're using node.js, run \`npm install ws\`, and then in your code:

import PartySocket from 'partysocket';
import WS from 'ws';

const partysocket = new PartySocket({
  host: "127.0.0.1:1999",
  room: "test-room",
  WebSocket: WS
});

`),a=!0);let s=this._options.WebSocket||WebSocket;this._debug("connect",{url:t,protocols:n}),this._ws=n?new s(t,n):new s(t),this._ws.binaryType=this._binaryType,this._connectLock=!1,this._addListeners(),this._connectTimeout=setTimeout(()=>this._handleTimeout(),e)}).catch(t=>{this._connectLock=!1,this._handleError(new i.ErrorEvent(Error(t.message),this))})}_handleTimeout(){this._debug("timeout event"),this._handleError(new i.ErrorEvent(Error("TIMEOUT"),this))}_disconnect(t=1e3,e){if(this._clearTimeouts(),this._ws){this._removeListeners();try{this._ws.close(t,e),this._handleClose(new i.CloseEvent(t,e,this))}catch(t){}}}_acceptOpen(){this._debug("accept open"),this._retryCount=0}_handleOpen=t=>{this._debug("open event");let{minUptime:e=u.minUptime}=this._options;clearTimeout(this._connectTimeout),this._uptimeTimeout=setTimeout(()=>this._acceptOpen(),e),function(t,e){if(!t)throw Error(e)}(this._ws,"WebSocket is not defined"),this._ws.binaryType=this._binaryType,this._messageQueue.forEach(t=>this._ws?.send(t)),this._messageQueue=[],this.onopen&&this.onopen(t),this.dispatchEvent(c(t))};_handleMessage=t=>{this._debug("message event"),this.onmessage&&this.onmessage(t),this.dispatchEvent(c(t))};_handleError=t=>{this._debug("error event",t.message),this._disconnect(void 0,"TIMEOUT"===t.message?"timeout":void 0),this.onerror&&this.onerror(t),this._debug("exec error listeners"),this.dispatchEvent(c(t)),this._connect()};_handleClose=t=>{this._debug("close event"),this._clearTimeouts(),this._shouldReconnect&&this._connect(),this.onclose&&this.onclose(t),this.dispatchEvent(c(t))};_removeListeners(){this._ws&&(this._debug("removeListeners"),this._ws.removeEventListener("open",this._handleOpen),this._ws.removeEventListener("close",this._handleClose),this._ws.removeEventListener("message",this._handleMessage),this._ws.removeEventListener("error",this._handleError))}_addListeners(){this._ws&&(this._debug("addListeners"),this._ws.addEventListener("open",this._handleOpen),this._ws.addEventListener("close",this._handleClose),this._ws.addEventListener("message",this._handleMessage),this._ws.addEventListener("error",this._handleError))}_clearTimeouts(){clearTimeout(this._connectTimeout),clearTimeout(this._uptimeTimeout)}},h=t=>null!==t[1]&&void 0!==t[1];function d(t,e,n={}){let{host:s,path:r,protocol:o,room:i,party:c,query:u}=t,a=s.replace(/^(http|https|ws|wss):\/\//,"");if(a.endsWith("/")&&(a=a.slice(0,-1)),r&&r.startsWith("/"))throw Error("path must not start with a slash");let l=r?`/${r}`:"",d=o||(a.startsWith("localhost:")||a.startsWith("127.0.0.1:")||a.startsWith("192.168.")||a.startsWith("10.")||a.startsWith("172.")&&a.split(".")[1]>="16"&&a.split(".")[1]<="31"||a.startsWith("[::ffff:7f00:1]:")?e:e+"s"),f=`${d}://${a}/${c?`parties/${c}`:"party"}/${i}${l}`,p=(t={})=>`${f}?${new URLSearchParams([...Object.entries(n),...Object.entries(t).filter(h)])}`;return{host:a,path:l,room:i,name:c??"main",protocol:d,partyUrl:f,urlProvider:"function"==typeof u?async()=>p(await u()):p(u)}}var f=class extends l{constructor(t){let e=p(t);super(e.urlProvider,e.protocols,e.socketOptions),this.partySocketOptions=t,this.setWSProperties(e)}_pk;_pkurl;name;room;host;path;updateProperties(t){let e=p({...this.partySocketOptions,...t,host:t.host??this.host,room:t.room??this.room,path:t.path??this.path});this._url=e.urlProvider,this._protocols=e.protocols,this._options=e.socketOptions,this.setWSProperties(e)}setWSProperties(t){let{_pk:e,_pkurl:n,name:s,room:r,host:o,path:i}=t;this._pk=e,this._pkurl=n,this.name=s,this.room=r,this.host=o,this.path=i}reconnect(t,e){if(!this.room||!this.host)throw Error("The room and host must be set before connecting, use `updateProperties` method to set them or pass them to the constructor.");super.reconnect(t,e)}get id(){return this._pk}get roomUrl(){return this._pkurl}static async fetch(t,e){let n=d(t,"http"),s="string"==typeof n.urlProvider?n.urlProvider:await n.urlProvider();return(t.fetch??fetch)(s,e)}};function p(t){let{id:e,host:n,path:s,party:r,room:o,protocol:i,query:c,protocols:u,...a}=t,l=e||function(){if("undefined"!=typeof crypto&&crypto.randomUUID)return crypto.randomUUID();let t=new Date().getTime(),e="undefined"!=typeof performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){let s=16*Math.random();return t>0?(s=(t+s)%16|0,t=Math.floor(t/16)):(s=(e+s)%16|0,e=Math.floor(e/16)),("x"===n?s:3&s|8).toString(16)})}(),h=d(t,"ws",{_pk:l});return{_pk:l,_pkurl:h.partyUrl,name:h.name,room:h.room,host:h.host,path:h.path,protocols:u,socketOptions:a,urlProvider:h.urlProvider}}var g=n(11979),m=(t,e)=>{let n=(0,g.useRef)(e);n.current=e,(0,g.useEffect)(()=>{let e=t=>n.current?.onOpen?.(t),s=t=>n.current?.onMessage?.(t),r=t=>n.current?.onClose?.(t),o=t=>n.current?.onError?.(t);return t.addEventListener("open",e),t.addEventListener("close",r),t.addEventListener("error",o),t.addEventListener("message",s),()=>{t.removeEventListener("open",e),t.removeEventListener("close",r),t.removeEventListener("error",o),t.removeEventListener("message",s)}},[t])},y=t=>[t.startClosed,t.minUptime,t.maxRetries,t.connectionTimeout,t.maxEnqueuedMessages,t.maxReconnectionDelay,t.minReconnectionDelay,t.reconnectionDelayGrowFactor,t.debug];function _(t){let{host:e,...n}=t,s=function({options:t,createSocket:e,createSocketMemoKey:n}){let s=n(t),r=(0,g.useMemo)(()=>t,[s]),[o,i]=(0,g.useState)(()=>e({...r,startClosed:!0})),c=(0,g.useRef)(null),u=(0,g.useRef)(e);return u.current=e,(0,g.useEffect)(()=>{if(c.current!==o)return c.current||!0===r.startClosed||o.reconnect(),c.current=o,()=>{o.close()};i(u.current({...r,startClosed:!1}))},[o,r]),o}({options:{host:e||("undefined"!=typeof window?window.location.host:"dummy-domain.com"),...n},createSocket:t=>new f(t),createSocketMemoKey:t=>JSON.stringify([t.query,t.id,t.host,t.room,t.party,t.path,t.protocol,t.protocols,...y(t)])});return m(s,t),s}},33639:function(t,e,n){n.d(e,{ZP:function(){return j}});var s=!1,r=(t,e)=>{if(t.byteLength<=1e6){e.send(t);return}s||(console.warn("[y-partykit]","The Y.js update size exceeds 1MB, which is the maximum size for an individual update. The update will be split into chunks. This is an experimental feature.",`Message size: ${(t.byteLength/1e3/1e3).toFixed(1)}MB`),s=!0);let n=(Date.now()+Math.random()).toString(36).substring(10),r=Math.ceil(t.byteLength/1e6);e.send(o({id:n,type:"start",size:t.byteLength,count:r}));let i=0,c=0;for(let n=0;n<r;n++){let s=t.slice(1e6*n,1e6*(n+1));e.send(s),c+=1,i+=s.byteLength}e.send(o({id:n,type:"end",size:i,count:c}))};function o(t){return`y-pk-batch#${JSON.stringify(t)}`}var i=n(89838),c=n(83896),u=n(98243),a=n(46038);let l=new Map;class h{constructor(t){this.room=t,this.onmessage=null,this._onChange=e=>e.key===t&&null!==this.onmessage&&this.onmessage({data:u.Gh(e.newValue||"")}),a.z2(this._onChange)}postMessage(t){a.XN.setItem(this.room,u.s3(u.eh(t)))}close(){a.F(this._onChange)}}let d="undefined"==typeof BroadcastChannel?h:BroadcastChannel,f=t=>i.Yu(l,t,()=>{let e=c.Ue(),n=new d(t);return n.onmessage=t=>e.forEach(e=>e(t.data,"broadcastchannel")),{bc:n,subs:e}}),p=(t,e)=>(f(t).subs.add(e),e),g=(t,e)=>{let n=f(t),s=n.subs.delete(e);return s&&0===n.subs.size&&(n.bc.close(),l.delete(t)),s},m=(t,e,n=null)=>{let s=f(t);s.bc.postMessage(e),s.subs.forEach(t=>t(e,n))};var y=n(9685),_=n(55999),w=n(34850),b=n(3822),v=n(34002),E=n(31399);let x=t=>E.UI(t,(t,e)=>`${encodeURIComponent(e)}=${encodeURIComponent(t)}`).join("&"),S=(t,e,n)=>{0===y.yg(t)&&n(e,y.kf(t))};var U=n(12577),k=n(31671);let C=(t,e)=>{_.uE(t,0);let n=k.gJ(e);_.mP(t,n)},L=(t,e,n)=>{_.uE(t,1),_.mP(t,k.D$(e,n))},T=(t,e,n)=>L(e,n,y.HN(t)),M=(t,e,n)=>{try{k.NG(e,y.HN(t),n)}catch(t){console.error("Caught error while handling a Yjs update",t)}},O=(t,e)=>{_.uE(t,2),_.mP(t,e)},P=(t,e,n,s)=>{let r=y.yg(t);switch(r){case 0:T(t,e,n);break;case 1:case 2:M(t,n,s);break;default:throw Error("Unknown message type")}return r};var I=n(32608),N="undefined"==typeof window,D=[];function R(t,e,n){let s=y.l1(e),r=_.Mf(),o=y.yg(s),i=t.messageHandlers[o];return i?i(r,s,t,n,o):console.error("Unable to compute message"),r}function A(t,e){let n=t.ws;t.wsconnected&&n&&n.readyState===n.OPEN&&r(e,n),t.bcconnected&&m(t.bcChannel,e,t)}D[0]=(t,e,n,s,r)=>{_.uE(t,0);let o=P(e,t,n.doc,n);s&&1===o&&!n.synced&&(n.synced=!0)},D[3]=(t,e,n,s,r)=>{_.uE(t,1),_.mP(t,U.xq(n.awareness,Array.from(n.awareness.getStates().keys())))},D[1]=(t,e,n,s,r)=>{U.oy(n.awareness,y.HN(e),n)},D[2]=(t,e,n,s,r)=>{S(e,n.doc,(t,e)=>{console.warn(`Permission denied to access ${n.url}.
${e}`)})};var W="undefined"==typeof WebSocket?null:WebSocket,G=class extends b.y{maxBackoffTime;bcChannel;url;roomname;doc;_WS;awareness;wsconnected;wsconnecting;bcconnected;disableBc;wsUnsuccessfulReconnects;messageHandlers;_synced;ws;wsLastMessageReceived;shouldConnect;_resyncInterval;_bcSubscriber;_updateHandler;_awarenessUpdateHandler;_unloadHandler;_checkInterval;constructor(t,e,n,{connect:s=!0,awareness:o=new U.GL(n),params:i={},WebSocketPolyfill:c=W,resyncInterval:u=-1,maxBackoffTime:a=2500,disableBc:l=N}={}){for(super();"/"===t[t.length-1];)t=t.slice(0,t.length-1);let h=x(i);this.maxBackoffTime=a,this.bcChannel=t+"/"+e,this.url=t+"/"+e+(0===h.length?"":"?"+h),this.roomname=e,this.doc=n,this._WS=c,this.awareness=o,this.wsconnected=!1,this.wsconnecting=!1,this.bcconnected=!1,this.disableBc=l,this.wsUnsuccessfulReconnects=0,this.messageHandlers=D.slice(),this._synced=!1,this.ws=null,this.wsLastMessageReceived=0,this.shouldConnect=s,this._resyncInterval=0,u>0&&(this._resyncInterval=setInterval(()=>{if(this.ws&&this.ws.readyState===WebSocket.OPEN){let t=_.Mf();_.uE(t,0),C(t,n),r(_._f(t),this.ws)}},u)),this._bcSubscriber=(t,e)=>{if(e!==this){let e=R(this,new Uint8Array(t),!1);_.kE(e)>1&&m(this.bcChannel,_._f(e),this)}},this._updateHandler=(t,e)=>{if(e!==this){let e=_.Mf();_.uE(e,0),O(e,t),A(this,_._f(e))}},this.doc.on("update",this._updateHandler),this._awarenessUpdateHandler=({added:t,updated:e,removed:n},s)=>{let r=t.concat(e).concat(n),i=_.Mf();_.uE(i,1),_.mP(i,U.xq(o,r)),A(this,_._f(i))},this._unloadHandler=()=>{U.Ag(this.awareness,[n.clientID],"window unload")},"undefined"!=typeof window?window.addEventListener("unload",this._unloadHandler):void 0!==I&&"function"==typeof I.on&&I.on("exit",this._unloadHandler),o.on("update",this._awarenessUpdateHandler),this._checkInterval=setInterval(()=>{this.wsconnected&&3e4<v.ZG()-this.wsLastMessageReceived&&(function(t,e){if(!t)throw Error(e)}(null!==this.ws,"ws must not be null"),this.ws.close())},3e3),s&&this.connect()}get synced(){return this._synced}set synced(t){this._synced!==t&&(this._synced=t,this.emit("synced",[t]),this.emit("sync",[t]))}destroy(){0!==this._resyncInterval&&clearInterval(this._resyncInterval),clearInterval(this._checkInterval),this.disconnect(),"undefined"!=typeof window?window.removeEventListener("unload",this._unloadHandler):void 0!==I&&"function"==typeof I.off&&I.off("exit",this._unloadHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.doc.off("update",this._updateHandler),super.destroy()}connectBc(){if(this.disableBc)return;this.bcconnected||(p(this.bcChannel,this._bcSubscriber),this.bcconnected=!0);let t=_.Mf();_.uE(t,0),C(t,this.doc),m(this.bcChannel,_._f(t),this);let e=_.Mf();_.uE(e,0),L(e,this.doc),m(this.bcChannel,_._f(e),this);let n=_.Mf();_.uE(n,3),m(this.bcChannel,_._f(n),this);let s=_.Mf();_.uE(s,1),_.mP(s,U.xq(this.awareness,[this.doc.clientID])),m(this.bcChannel,_._f(s),this)}disconnectBc(){let t=_.Mf();_.uE(t,1),_.mP(t,U.xq(this.awareness,[this.doc.clientID],new Map)),A(this,_._f(t)),this.bcconnected&&(g(this.bcChannel,this._bcSubscriber),this.bcconnected=!1)}disconnect(){this.shouldConnect=!1,this.disconnectBc(),null!==this.ws&&this.ws.close()}connect(){this.shouldConnect=!0,this.wsconnected||null!==this.ws||(function t(e){if(e.shouldConnect&&null===e.ws){if(!e._WS)throw Error("No WebSocket implementation available, did you forget to pass options.WebSocketPolyfill?");let n=new e._WS(e.url);n.binaryType="arraybuffer",e.ws=n,e.wsconnecting=!0,e.wsconnected=!1,e.synced=!1,n.addEventListener("message",t=>{if("string"==typeof t.data)return;e.wsLastMessageReceived=v.ZG();let s=R(e,new Uint8Array(t.data),!0);_.kE(s)>1&&r(_._f(s),n)}),n.addEventListener("error",t=>{e.emit("connection-error",[t,e])}),n.addEventListener("close",n=>{e.emit("connection-close",[n,e]),e.ws=null,e.wsconnecting=!1,e.wsconnected?(e.wsconnected=!1,e.synced=!1,U.Ag(e.awareness,Array.from(e.awareness.getStates().keys()).filter(t=>t!==e.doc.clientID),e),e.emit("status",[{status:"disconnected"}])):e.wsUnsuccessfulReconnects++,setTimeout(t,w.VV(100*w.sQ(2,e.wsUnsuccessfulReconnects),e.maxBackoffTime),e)}),n.addEventListener("open",()=>{e.wsLastMessageReceived=v.ZG(),e.wsconnecting=!1,e.wsconnected=!0,e.wsUnsuccessfulReconnects=0,e.emit("status",[{status:"connected"}]);let t=_.Mf();if(_.uE(t,0),C(t,e.doc),r(_._f(t),n),null!==e.awareness.getLocalState()){let t=_.Mf();_.uE(t,1),_.mP(t,U.xq(e.awareness,[e.doc.clientID])),r(_._f(t),n)}}),e.emit("status",[{status:"connecting"}])}}(this),this.connectBc())}};function $(t,e,n){if(typeof t!==n)throw Error(`Invalid "${e}" parameter provided to YPartyKitProvider. Expected: ${n}, received: ${t}`)}var j=class extends G{id;#t;constructor(t,e,n,s={}){$(t,"host","string"),$(e,"room","string"),(t=t.replace(/^(http|https|ws|wss):\/\//,"")).endsWith("/")&&t.slice(0,-1);let r=`${s.protocol||(t.startsWith("localhost:")||t.startsWith("127.0.0.1:")||t.startsWith("192.168.")||t.startsWith("10.")||t.startsWith("172.")&&t.split(".")[1]>="16"&&t.split(".")[1]<="31"?"ws":"wss")}://${t}${s.party?`/parties/${s.party}`:"/party"}`,o=s.connectionId??function(){if(crypto&&crypto.randomUUID)return crypto.randomUUID();let t=new Date().getTime(),e="undefined"!=typeof performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){let s=16*Math.random();return t>0?(s=(t+s)%16|0,t=Math.floor(t/16)):(s=(e+s)%16|0,e=Math.floor(e/16)),("x"===n?s:3&s|8).toString(16)})}(),{params:i,connect:c=!0,...u}=s;super(r,e,n??new k.QW,{...u,connect:!1}),this.id=o,this.#t=i,c&&this.connect()}connect(){Promise.resolve("function"==typeof this.#t?this.#t():this.#t).then(t=>{let e=new URLSearchParams([["_pk",this.id]]);if(t)for(let[n,s]of Object.entries(t))null!=s&&e.append(n,s);let n=new URL(this.url);n.search=e.toString(),this.url=n.toString(),super.connect()}).catch(t=>{throw console.error("Failed to open connecton to PartyKit",t),Error(t)})}}},12577:function(t,e,n){n.d(e,{Ag:function(){return l},GL:function(){return a},oy:function(){return d},xq:function(){return h}});var s=n(55999),r=n(9685),o=n(34002),i=n(34850),c=n(3822),u=n(56503);class a extends c.y{constructor(t){super(),this.doc=t,this.clientID=t.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{let t=o.ZG();null!==this.getLocalState()&&15e3<=t-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());let e=[];this.meta.forEach((n,s)=>{s!==this.clientID&&3e4<=t-n.lastUpdated&&this.states.has(s)&&e.push(s)}),e.length>0&&l(this,e,"timeout")},i.GW(3e3)),t.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(t){let e=this.clientID,n=this.meta.get(e),s=void 0===n?0:n.clock+1,r=this.states.get(e);null===t?this.states.delete(e):this.states.set(e,t),this.meta.set(e,{clock:s,lastUpdated:o.ZG()});let i=[],c=[],a=[],l=[];null===t?l.push(e):null==r?null!=t&&i.push(e):(c.push(e),u.Hi(r,t)||a.push(e)),(i.length>0||a.length>0||l.length>0)&&this.emit("change",[{added:i,updated:a,removed:l},"local"]),this.emit("update",[{added:i,updated:c,removed:l},"local"])}setLocalStateField(t,e){let n=this.getLocalState();null!==n&&this.setLocalState({...n,[t]:e})}getStates(){return this.states}}let l=(t,e,n)=>{let s=[];for(let n=0;n<e.length;n++){let r=e[n];if(t.states.has(r)){if(t.states.delete(r),r===t.clientID){let e=t.meta.get(r);t.meta.set(r,{clock:e.clock+1,lastUpdated:o.ZG()})}s.push(r)}}s.length>0&&(t.emit("change",[{added:[],updated:[],removed:s},n]),t.emit("update",[{added:[],updated:[],removed:s},n]))},h=(t,e,n=t.states)=>{let r=e.length,o=s.Mf();s.uE(o,r);for(let i=0;i<r;i++){let r=e[i],c=n.get(r)||null,u=t.meta.get(r).clock;s.uE(o,r),s.uE(o,u),s.uw(o,JSON.stringify(c))}return s._f(o)},d=(t,e,n)=>{let s=r.l1(e),i=o.ZG(),c=[],a=[],l=[],h=[],d=r.yg(s);for(let e=0;e<d;e++){let e=r.yg(s),n=r.yg(s),o=JSON.parse(r.kf(s)),d=t.meta.get(e),f=t.states.get(e),p=void 0===d?0:d.clock;(p<n||p===n&&null===o&&t.states.has(e))&&(null===o?e===t.clientID&&null!=t.getLocalState()?n++:t.states.delete(e):t.states.set(e,o),t.meta.set(e,{clock:n,lastUpdated:i}),void 0===d&&null!==o?c.push(e):void 0!==d&&null===o?h.push(e):null!==o&&(u.Hi(o,f)||l.push(e),a.push(e)))}(c.length>0||l.length>0||h.length>0)&&t.emit("change",[{added:c,updated:l,removed:h},n]),(c.length>0||a.length>0||h.length>0)&&t.emit("update",[{added:c,updated:a,removed:h},n])}}}]);